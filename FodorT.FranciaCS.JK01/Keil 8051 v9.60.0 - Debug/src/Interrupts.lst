C51 COMPILER V9.60.0.0   INTERRUPTS                                                        09/26/2024 14:45:08 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE INTERRUPTS
OBJECT MODULE PLACED IN .\src\Interrupts.OBJ
COMPILER INVOKED BY: C:\SiliconLabs\SimplicityStudio\v5\developer\toolchains\keil_8051\9.60\BIN\C51.exe C:\Users\Teodor\
                    -Desktop\FodorT.FranciaCS.JK01\src\Interrupts.c OMF2 SMALL DEBUG OBJECTEXTEND ROM(LARGE) WARNINGLEVEL(2) FLOATFUZZY(3) OP
                    -TIMIZE(8,SPEED) DEFINE(DEBUG=1) INTVECTOR(0X0000) INTPROMOTE INCDIR(C:\Users\Teodor\Desktop\FodorT.FranciaCS.JK01\inc;C:
                    -/SiliconLabs/SimplicityStudio/v5/developer/sdks/8051/v4.2.5//Device/shared/si8051Base;C:/SiliconLabs/SimplicityStudio/v5
                    -/developer/sdks/8051/v4.2.5//Device/EFM8BB1/inc) PRINT(.\src\Interrupts.lst) COND PAGEWIDTH(120) PAGELENGTH(65) OBJECT(.
                    -\src\Interrupts.OBJ)

line level    source

   1          //=========================================================
   2          // src/Interrupts.c: generated by Hardware Configurator
   3          //
   4          // This file will be regenerated when saving a document.
   5          // leave the sections inside the "$[...]" comment tags alone
   6          // or they will be overwritten!
   7          //=========================================================
   8          
   9          // USER INCLUDES
  10          #include <SI_EFM8BB1_Register_Enums.h>
  11          #include <LIMITS.h>
  12          #include "Display.h"
  13          
  14          
  15          volatile uint16_t timer2_counter = 0;
  16          extern bool g_moving;
  17          SI_INTERRUPT (TIMER2_ISR, TIMER2_IRQn)
  18          {
  19   1              TMR2CN0_TF2H = 0;
  20   1              timer2_counter++;
  21   1      
  22   1              if(timer2_counter == UINT_MAX)
  23   1              {
  24   2                      g_moving = false;
  25   2              }
  26   1      }
  27          
  28          extern bool g_time_measurement_ready;
  29          extern uint16_t g_tick_counter;
  30          SI_INTERRUPT (INT0_ISR, INT0_IRQn)
  31          {
  32   1        static bool first_run = true;
  33   1              uint16_t temp_timer2_counter = 0;
  34   1              IE_ET2 = 0;
  35   1              temp_timer2_counter = timer2_counter;
  36   1              timer2_counter = 0;
  37   1              g_moving = true;
  38   1              IE_ET2 = 1;
  39   1      
  40   1              TCON_IE0 = 0;
  41   1      
  42   1              if (g_time_measurement_ready == false && first_run == false)
  43   1              {
  44   2                      g_tick_counter = temp_timer2_counter;
  45   2                      g_time_measurement_ready = true;
  46   2              }
  47   1        first_run = false;
  48   1      
  49   1      }
  50          
  51          extern volatile uint8_t digit_array[4];
C51 COMPILER V9.60.0.0   INTERRUPTS                                                        09/26/2024 14:45:08 PAGE 2   

  52          extern volatile bool g_digits_ready;
  53          SI_INTERRUPT (TIMER0_ISR, TIMER0_IRQn)
  54          {
  55   1              static uint16_t timer_0_counter = 0U;
  56   1              static uint8_t current_digit;
  57   1              static uint8_t idx = 1;
  58   1      
  59   1              TCON_TF0 = 0;
  60   1      
  61   1              timer_0_counter++;
  62   1              if(timer_0_counter == 5 && g_digits_ready == true)
  63   1              {
  64   2                send_to_shift_register(CLEAR_DISP_BCD);
  65   2                      current_digit = digit_array[idx];
  66   2                      select_display(idx);
  67   2                      send_to_shift_register(current_digit);
  68   2                      idx++;
  69   2                      if(idx > 3)
  70   2                      {
  71   3                              idx = 2;
  72   3                              g_digits_ready = false;
  73   3                      }
  74   2                      timer_0_counter = 0;
  75   2              }
  76   1      }
  77          
  78          #define SW2 P0_B7
  79          #define DEBOUNCE_DELAY ((uint16_t) 50)
  80          extern volatile bool g_button_pressed;
  81          
  82          SI_INTERRUPT (TIMER1_ISR, TIMER1_IRQn)
  83          {
  84   1              static uint16_t debounce_counter = 0U;
  85   1              static bool push_detected = false;
  86   1      
  87   1              TCON_TF1 = 0;
  88   1      
  89   1              if (SW2 == 0)
  90   1              {
  91   2                  if (debounce_counter < DEBOUNCE_DELAY)
  92   2                  {
  93   3                      debounce_counter++;
  94   3                  }
  95   2                  else if (push_detected == false)
  96   2                  {
  97   3                      g_button_pressed = true;
  98   3                      push_detected = true;
  99   3                  }
 100   2              }
 101   1              else
 102   1              {
 103   2                  debounce_counter = 0U;
 104   2                  push_detected = false;
 105   2              }
 106   1      
 107   1      }
 108          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    268    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
C51 COMPILER V9.60.0.0   INTERRUPTS                                                        09/26/2024 14:45:08 PAGE 3   

   PDATA SIZE       =   ----    ----
   DATA SIZE        =      8    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      2    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
